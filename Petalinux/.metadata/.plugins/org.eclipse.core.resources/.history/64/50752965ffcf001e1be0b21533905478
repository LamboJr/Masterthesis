#include "../Includes/DataTypes.h"
#include <stdio.h>

#include "../Includes/Ringbuffer.h"

// DEclare a buffer structure for a Buffer with Data to be send to Ringbuffer of HW
struct BufferType s_DataBuffer;
// DEclare a buffer structure for a Buffer with Data to be send to Ringbuffer of HW
struct BufferType s_ControlBuffer;

uint16_t DataBuffer[MAX_BUFFER_LENGTH];
uint16_t DataBufferWriteIndex = 0;
uint16_t DataBufferReadIndex = 0;


u16 ControlBuffer[MAX_BUFFER_LENGTH];
u16 ControlBufferWriteIndex = 0;
u16 ControlBufferReadIndex = 0;

void ResetBuffer(struct BufferType *Buffer){
	Buffer -> WriteIndex = 0;
	Buffer -> ReadIndex = 0;
}
u16 ReadBuffer(struct BufferType *Buffer){
	u16 returnvalue = 0;
	//If Head == Tail Buffer is empty. return 0;
	if (Buffer->ReadIndex == Buffer->WriteIndex){
		return returnvalue;
	}else{
		returnvalue = Buffer->Data[Buffer->ReadIndex];
		if (Buffer->ReadIndex >= (MAX_BUFFER_LENGTH-1)){
			Buffer->ReadIndex = 0;
		}
		else{
			Buffer->ReadIndex++;
		}
		return returnvalue;
	}

}
s8 WriteBuffer(u16 datainput, struct BufferType *Buffer){
	Buffer->Data[Buffer->WriteIndex] = datainput;
	if (Buffer->WriteIndex >= (MAX_BUFFER_LENGTH-1) ){
		Buffer->WriteIndex = 0;
	}
	else{
		Buffer->WriteIndex++;
	}
	if (Buffer->WriteIndex == Buffer->ReadIndex){
		printf("Buffer full now\n");
		return 1;
	}
	return 0;
}


